define("SHARED/content-selector",["SHARED/jquery","SHARED/wcm-utils"],function(r,t){eXo.define.names=["gj","wcm_utils"];eXo.define.deps=[r,t];return function(f){function i(){this.portalName=eXo.env.portal.portalName;this.context=eXo.env.portal.context;this.accessMode=eXo.env.portal.accessMode;this.userLanguage=eXo.env.portal.language;this.userId=eXo.env.portal.userName;this.hostName=eXo.ecm.WCMUtils.getHostName();this.repositoryName="repository";this.workspaceName="collaboration";this.cmdEcmBundle=
"/bundle/";this.cmdGetBundle="getBundle?";this.cmdEcmDriver="/wcmDriver/";this.cmdGetDriver="getDrivers?";this.cmdGetFolderAndFile="getFoldersAndFiles?";this.resourceType=this.getUrlParam("Type")||"File";this.connector=this.getUrlParam("connector")||eXo.ecm.WCMUtils.getRestContext();this.currentFolder=this.currentNode="";this.xmlHttpRequest=!1;this.driverName="";this.eventNode=!1;this.uploadFile="uploadFile/upload";this.controlUpload="uploadFile/control";this.deleteConfirmationMsg=this.initComponentIdExpanded=
this.initPathExpanded=this.initDriverExpanded="";this.switchView=!1;if(void 0==this.viewType)this.viewType="list"}function m(a,b){this.tableName=a;this.itemsPerPage=b;this.currentPage=1;this.pages=0;this.inited=!1}i.prototype.setDeleteConfirmationMessage=function(a){this.deleteConfirmationMsg=a};i.prototype.getUrlParam=function(a){return(a=RegExp("[?&]"+a+"=([^&]+)","i").exec(window.location.search))&&1<a.length?a[1]:""};i.prototype.loadScript=function(){if(!(2>arguments.length)){var a=arguments[0],
b=arguments[1];if(a&&a.document){var d=a.document.createElement("script");d.setAttribute("src",b);a.document.getElementsByTagName("head")[0].appendChild(d)}}};i.prototype.ajaxRequest=function(a){if(window.XMLHttpRequest&&!window.ActiveXObject)try{eXo.ecm.ECS.xmlHttpRequest=new XMLHttpRequest}catch(b){eXo.ecm.ECS.xmlHttpRequest=!1}else if(window.ActiveXObject)try{eXo.ecm.ECS.xmlHttpRequest=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{eXo.ecm.ECS.xmlHttpRequest=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){eXo.ecm.ECS.xmlHttpRequest=
!1}}if(eXo.ecm.ECS.xmlHttpRequest)eXo.ecm.ECS.xmlHttpRequest.onreadystatechange=eXo.ecm.ECS.processResponse,eXo.ecm.ECS.xmlHttpRequest.open("GET",a,!0),eXo.ecm.ECS.xmlHttpRequest.send()};i.prototype.processResponse=function(){if(4==eXo.ecm.ECS.xmlHttpRequest.readyState)if(200==eXo.ecm.ECS.xmlHttpRequest.status)eXo.ecm.ECS.buildECSTreeView(),null!=eXo.ecm.ECS.initDriverExpanded&&0<eXo.ecm.ECS.initDriverExpanded.length&&eXo.ecm.ECS.waitAndInitPath(eXo.ecm.ECS.initDriverExpanded,eXo.ecm.ECS.initPathExpanded,
eXo.ecm.ECS.initComponentIdExpanded);else return alert("There was a problem retrieving the XML data:\n"+eXo.ecm.ECS.xmlHttpRequest.statusText),!1};i.prototype.initRequestXmlTree=function(a,b,d,c){this.initDriverExpanded=b;this.initPathExpanded=d;this.initComponentIdExpanded=c;if(a){eXo.ecm.ECS.typeObj=!1;switch(a){case "folder":eXo.ecm.ECS.typeObj="folder";break;case "multi":eXo.ecm.ECS.typeObj="multi";break;case "one":eXo.ecm.ECS.typeObj="one";break;case "editor":eXo.ecm.ECS.typeObj="editor";break;
default:eXo.ecm.ECS.typeObj=!1}eXo.ecm.ECS.isShowFilter();a=eXo.ecm.ECS;eXo.ecm.ECS.ajaxRequest(a.hostName+a.connector+(a.cmdEcmDriver+a.cmdGetDriver+"lang="+a.userLanguage))}};i.prototype.buildECSTreeView=function(){for(var a="",b=eXo.ecm.ECS.xmlHttpRequest.responseXML.getElementsByTagName("Folders"),d=0;d<b.length;d++){var c=b[d].getAttribute("name"),g=eXo.ecm.ECS.generateIdDriver(b[d]),e=b[d].getAttribute("isUpload"),h=b[d].getAttribute("nodeDriveName");null==h&&(h="");var k=eXo.ecm.ECS.renderSubTree(b[d]);
""==k?(a+='<div class="node">',a+='<div class="emptyIcon">'):(a+='<div class="node" onclick="eXo.ecm.ECS.actionColExp(this, event);">',a+='<div class="expandIcon">');a+='<a rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(c)+'"href="javascript:void(0);" class="nodeIcon" onclick="eXo.ecm.ECS.renderBreadcrumbs(this);eXo.ecm.ECS.listRootFolder(this);" name="'+decodeURIComponent(c)+'" id="'+g+'" isUpload="'+e+'" nodeDriveName="'+h+'">';a+='<i class="uiIcon16x16FolderDefault"></i>';a+=
'<span class="nodeName"> ';a+=decodeURIComponent(c);a+="</span>";a+="</a>";a+="</div>";a+="</div>";""!=k&&(a+=k)}(b=document.getElementById("LeftWorkspace"))&&f(b).html(a);if(a=document.getElementById("CorrectContentSelectorPopupWindow"))if(a=f(a).find("div.PopupContent:first")[0])a.style.height="";f(document).ready(function(){f("*[rel='tooltip']").tooltip()})};i.prototype.getDir=function(a,b){var d=eXo.ecm.ECS;if(b)eXo.ecm.ECS.eventNode=b;var c=a.getAttribute("repository");if(c)eXo.ecm.ECS.repositoryName=
c;if(c=a.getAttribute("workspace"))eXo.ecm.ECS.workspaceName=c;var g,e;e=a.getAttribute("driverPath");c=a.getAttribute("nodedrivename");if(e&&""!=e)e=a.getAttribute("name"),eXo.ecm.ECS.driverName=e,g="",eXo.ecm.ECS.showUpload();else if(a.getAttribute("isUpload")){g=f(a).parents(".ChildrenContainer:first")[0];if(!g)return;g=f(g).prevAll("div:first")[0];if(!g)return;g=(g=f(g).find("a.nodeIcon:first")[0])?g.getAttribute("currentFolder")&&null!=g.getAttribute("currentFolder")?g.getAttribute("currentFolder")+
"/"+a.getAttribute("name"):a.getAttribute("name"):a.getAttribute("name");a.setAttribute("currentFolder",g);eXo.ecm.ECS.showUpload()}eXo.ecm.ECS.currentFolder=g;eXo.ecm.ECS.currentNode=a;e=eXo.ecm.ECS.driverName;var h="";if(null!=c&&0<c.length)eXo.ecm.ECS.driverName=e=c;h=(c=document.getElementById("Filter"))?"hidden"==c.type?c.value:c.options[c.selectedIndex].value:"All";g=d.cmdEcmDriver+d.cmdGetFolderAndFile+"driverName="+e+"&currentFolder="+encodeURIComponent(g)+"&currentPortal="+d.portalName+"&repositoryName="+
d.repositoryName+"&workspaceName="+d.workspaceName;d=d.hostName+d.connector+g+"&filterBy="+h;eXo.ecm.ECS.strConnection=d;eXo.ecm.ECS.renderSubTrees(a,b,d);eXo.ecm.ECS.renderBreadcrumbs(a);f(document).ready(function(){f("*[rel='tooltip']").tooltip()})};i.prototype.renderSubTree=function(a){if(a){var b=a.getElementsByTagName("Folder");a.getElementsByTagName("Folders");a="";if(b&&0<b.length){for(var a=a+'<div class="ChildrenContainer" style="display:none;">',d=0;d<b.length;d++){var c=eXo.ecm.ECS.generateIdDriver(b[d]),
f=b[d].getAttribute("name"),e=b[d].getAttribute("driverPath"),h=b[d].getAttribute("repository"),k=b[d].getAttribute("workspace");b[d].getAttribute("isUpload");var i=b[d].getAttribute("label");b[d].getAttribute("nodeDriveName");var l=b[d].getAttribute("hasFolderChild");i||(i=f);a+='<div class="node" onclick="eXo.ecm.ECS.actionColExp(this, event);">';"true"==l?(a+='<div class="expandIcon">',a+='<a rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(i)+'" href="javascript:void(0);" class="nodeIcon" onclick="eXo.ecm.ECS.getDir(this, event);" name="'+
decodeURIComponent(f)+'" id="'+c+'"  driverPath="'+e+'" hasFolderChild="'+l+'" repository="'+h+'" workspace="'+k+'">'):(a+='<div class="emptyIcon">',a+='<a rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(i)+'" href="javascript:void(0);" class="nodeIcon" name="'+decodeURIComponent(f)+'" id="'+c+'"  driverPath="'+e+'" repository="'+h+'" workspace="'+k+'">');a+='<i class="uiIconEcms16x16DriveGeneral"></i>';a+='<span class="nodeName"> ';a+=i;a+="</span>";a+="</a>";a+="</div>";a+="</div>"}a+=
"</div>"}return a}};i.prototype.listRootFolder=function(a){eXo.ecm.ECS.hideUpload();if("folder"!=eXo.ecm.ECS.typeObj)"multi"==eXo.ecm.ECS.typeObj?eXo.ecm.ECS.listMutilFiles(null):eXo.ecm.ECS.listFiles(null);else{var b=document.getElementById("RightWorkspace"),d=f(b).find("table")[0],c=f(d).find("tr");if(c&&0<c.length)for(b=0;b<c.length;b++)0<b&&d.deleteRow(c[b].rowIndex);"string"==typeof a&&(a=document.getElementById(a));d=a.getAttribute("name");document.getElementById(a.getAttribute("id"));a=eXo.ecm.ECS;
a=eXo.ecm.WCMUtils.request(a.hostName+a.connector+(a.cmdEcmDriver+a.cmdGetDriver+"lang="+a.userLanguage)).getElementsByTagName("Folders");for(b=0;b<a.length;b++)a[b].getAttribute("name")==d&&eXo.ecm.ECS.listFolders(a[b].childNodes)}};i.prototype.renderSubTrees=function(a,b,d){if(b=b||window.event)b.cancelBubble=!0;if(a){var c="",g="",b="",e=a.getElementsByTagName("Folder");if(e&&0<e.length){b=e;g=a.getElementsByTagName("File");c+='<div class="ChildrenContainer" style="display:none;">';for(d=0;d<e.length;d++){var h=
eXo.ecm.ECS.generateIdNodes(e[d],a.id),k=e[d].getAttribute("title");k||(k=e[d].getAttribute("data-original-title"));var i=e[d].getAttribute("name"),l=e[d].getAttribute("isUpload"),n=e[d].getAttribute("nodeDriveName"),p=e[d].getAttribute("hasFolderChild"),o=e[d].getAttribute("nodeTypeCssClass");null==n&&(n="");c+='<div class="node" onclick="eXo.ecm.ECS.actionColExp(this, event);">';!0==p?(c+='<div class="expandIcon">',c+='<a rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(k)+'" href="javascript:void(0);" class="nodeIcon" onclick="eXo.ecm.ECS.getDir(this, event);" name="'+
decodeURIComponent(i)+'" id="'+h+'" hasFolderChild="'+p+'" isUpload="'+l+'" nodeDriveName="'+n+'">'):(c+='<div class="emptyIcon">',c+='<a rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(k)+'" href="javascript:void(0);" class="nodeIcon" name="'+decodeURIComponent(i)+'" id="'+h+'" isUpload="'+l+'" nodeDriveName="'+n+'">');c+='<i class="'+o+'"></i>';c+='<span class="nodeName"> ';c+=decodeURIComponent(k);c+="</span>";c+="</a>";c+="</div>";c+="</div>"}}else if(g=eXo.ecm.WCMUtils.request(d),
b=e=g.getElementsByTagName("Folder"),g=g.getElementsByTagName("File"),e&&0<e.length){for(d=0;d<e.length;d++)h=eXo.ecm.ECS.generateIdNodes(e[d],a.id),(k=e[d].getAttribute("title"))||(k=e[d].getAttribute("data-original-title")),i=e[d].getAttribute("name"),l=e[d].getAttribute("isUpload"),n=e[d].getAttribute("nodeDriveName"),p=e[d].getAttribute("hasFolderChild"),o=e[d].getAttribute("nodeTypeCssClass"),null==n&&(n=""),c+='<div class="node" onclick="eXo.ecm.ECS.actionColExp(this, event);">',"true"==p?(c+=
'<div class="expandIcon">',c+='<a rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(k)+'" href="javascript:void(0);" class="nodeIcon" onclick="eXo.ecm.ECS.getDir(this, event);" name="'+decodeURIComponent(i)+'" id="'+h+'" hasFolderChild="'+p+'" isUpload="'+l+'" nodeDriveName="'+n+'">'):(c+='<div class="emptyIcon">',c+='<a rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(k)+'" href="javascript:void(0);" class="nodeIcon" name="'+decodeURIComponent(i)+'" id="'+h+'" isUpload="'+
l+'" nodeDriveName="'+n+'">'),c+='<i class="'+o+'"></i>',c+='<span class="nodeName"> ',c+=decodeURIComponent(k),c+="</span>",c+="</a>",c+="</div>",c+="</div>";h=f(a).parents(".node:first")[0];e=f(a).parents("div:first")[0];k=f(h).nextAll("div:first")[0];d=document.createElement("div");d.className="ChildrenContainer";f(d).html(c);k&&"node"==k.className?(k.parentNode.insertBefore(d,k),e.className="collapseIcon",d.style.display="block"):k&&"ChildrenContainer"==k.className?eXo.ecm.ECS.actionColExp(h):
(a=f(a).parents(".ChildrenContainer:first")[0],e.className="collapseIcon",a.appendChild(d))}"folder"==eXo.ecm.ECS.typeObj?eXo.ecm.ECS.listFolders(b):"multi"==eXo.ecm.ECS.typeObj?eXo.ecm.ECS.listMutilFiles(g):eXo.ecm.ECS.listFiles(g)}};i.prototype.actionColExp=function(a,b){if(a){var d=f(a).nextAll("div:first")[0],c=f(a).children("div")[0];f(c).children("a")[0].getAttribute("hasFolderChild");if(!d||"ChildrenContainer"!=d.className){var g=f(a).find("a.nodeIcon:first")[0];if(null!=g)eXo.ecm.ECS.getDir(g,
!1);else return}if("collapseIcon"!=c.className){if(null!=d&&"ChildrenContainer"==d.className)d.style.display="block";if(b&&"emptyIcon"!=c.className||!b)c.className="collapseIcon"}else if(!eXo.ecm.ECS.switchView){eXo.ecm.ECS.switchView=!1;if(null!=d&&"ChildrenContainer"==d.className)d.style.display="none";if(b&&"emptyIcon"!=c.className||!b)c.className="expandIcon"}}};i.prototype.renderBreadcrumbs=function(a){if(a){"string"==typeof a&&(a=document.getElementById(a));eXo.ecm.ECS.currentNode=a;var b=document.getElementById("BreadcumbsContainer");
f(b).html('<li><i class="uiIconHome uiIconLightGray"></i></li>');for(var d=null;null!=a&&"leftWorkspace"!=a.className;){var c=f(a).attr("name"),g=f(a).attr("title");g||(g=f(a).attr("data-original-title"));if(c){var c=document.createElement("li"),e="",h="",h=document.getElementById(a.id),h=!h.getAttribute("driverPath")&&!h.getAttribute("currentfolder")?"eXo.ecm.ECS.actionBreadcrumbs('"+h.id+"');eXo.ecm.ECS.listRootFolder('"+h.id+"');":"eXo.ecm.ECS.actionBreadcrumbs('"+h.id+"');",e=e+'<i class="uiIconMiniArrowRight"></i>';
null==d?(e+='<a class="active" href="javascript:void(0);" onclick="'+h+'">'+decodeURIComponent(g)+"</a>",f(c).html(e),b.appendChild(c)):(e+='<a class="" href="javascript:void(0);" onclick="'+h+'">'+decodeURIComponent(g)+"</a>",f(c).html(e),b.insertBefore(c,d));d=c}a=a.parentNode;null!=a&&"ChildrenContainer"==a.className&&(a=f(a).prevAll("div:first")[0],a=a.getElementsByTagName("div")[0].getElementsByTagName("a")[0])}}};i.prototype.actionBreadcrumbs=function(a){var b=eXo.ecm.ECS,d=document.getElementById(a),
a=f(d).parents(".node:first")[0];eXo.ecm.ECS.actionColExp(a);eXo.ecm.ECS.renderBreadcrumbs(d);var c;if(d.getAttribute("driverPath"))c=d.getAttribute("name"),eXo.ecm.ECS.driverName=c,a="";else if(d.getAttribute("currentfolder"))a=d.getAttribute("currentfolder");else return;eXo.ecm.ECS.currentFolder=a;eXo.ecm.ECS.currentNode=d;c=eXo.ecm.ECS.driverName;d="";d=(d=document.getElementById("Filter"))?d.options[d.selectedIndex].value:"All";null==a&&(eXo.ecm.ECS.hideUpload(),a="");b=b.hostName+b.connector+
(b.cmdEcmDriver+b.cmdGetFolderAndFile+"driverName="+c+"&currentFolder="+a+"&currentPortal="+b.portalName+"&repositoryName="+b.repositoryName+"&workspaceName="+b.workspaceName)+"&filterBy="+d;if(eXo.ecm.ECS.strConnection!=b&&(eXo.ecm.ECS.strConnection=b,b=eXo.ecm.WCMUtils.request(b)))"folder"==eXo.ecm.ECS.typeObj?(b=b.getElementsByTagName("Folder"),eXo.ecm.ECS.listFolders(b)):"multi"==eXo.ecm.ECS.typeObj?(b=b.getElementsByTagName("File"),eXo.ecm.ECS.listMutilFiles(b)):(b=b.getElementsByTagName("File"),
eXo.ecm.ECS.listFiles(b))};i.prototype.listFiles=function(a){var b=eXo.ecm.ECS,d=eXo.ecm.ECS.viewType,c=document.getElementById("RightWorkspace");if(!a||0>=a.length){if("list"==d){var g=f(c).find("table")[0],e=f(g).find("tr");if(e&&0<e.length)for(var h=0;h<e.length;h++)0<h&&g.deleteRow(e[h].rowIndex);a=g.tBodies[0].insertRow(0).insertCell(0);f(a).html("There is no content");a.className="item noContent empty center";a.setAttribute("colspan",3);a.userLanguage="UserLanguage.NoContent"}else e=f(c).find("div.actionIconsContainer:first")[0],
f(e).html('<div class="noContent" userLanguage="UserLanguage.NoContent">There is no content</div>');f("#pageNavPosition").html("")}else{if("list"==d)if(g=f(c).find("table")[0]){if((e=f(g).find("tr"))&&0<e.length)for(h=0;h<e.length;h++)0<h&&g.deleteRow(e[h].rowIndex)}else eXo.ecm.ECS.updateHTML(d);else(e=f(c).find("div.actionIconsContainer:first")[0])?f(e).html(""):eXo.ecm.ECS.updateHTML(d);if(e=f(c).find("div.actionIconsContainer:first")[0])e.style.display="none";var i="",s="src";8<a.length&&(s="longDesc");
for(h=0;h<a.length;h++){var l=a[h].getAttribute("url"),l=encodeURIComponent(l),n=a[h].getAttribute("path"),p=a[h].getAttribute("nodeType"),g=p.replace(":","_")+"48x48Icon default16x16Icon",o=a[h].getAttribute("name"),o=encodeURIComponent(o),q=a[h].getAttribute("size"),q=0==q?"":q+"&nbsp;kb";if("list"==d)g=f(c).find("table")[0],eXo.ecm.ECS.getClazzIcon(a[h].getAttribute("nodeType")),g=g.tBodies[0].insertRow(h),g.className="OddItem",f(g.insertCell(0)).html('<a url="'+decodeURIComponent(l)+'" path="'+
n+'" nodeType="'+p+'" style = "overflow:hidden;" rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(o)+'" onclick="eXo.ecm.ECS.insertContent(this);">'+decodeURIComponent(o)+"</a>"),f(g.insertCell(1)).html('<div class="Item">'+a[h].getAttribute("dateCreated")+"</div>"),f(g.insertCell(2)).html('<div class="Item">'+q+"</div>");else var q=Math.random(),r=b.connector+"/thumbnailImage/medium/"+b.repositoryName+"/"+b.workspaceName+n+"/?reloadnum="+q,i=i+('<div id="'+q+'" class="actionIconBox" onclick="eXo.ecm.ECS.insertContent(this);" url="'+
decodeURIComponent(l)+'" path="'+n+'" nodeType="'+p+'" rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(o)+'"><div class="nodeLabel"><div class="thumbnailImage"><div style="display: block;" class="LoadingProgressIcon"><img alt="Loading Process" id="thumbnail'+q+'" '+s+'="'+r+"\" onerror=\"var img = gj(this.parentNode).next('i:first')[0]; img.style.display = 'block'; this.parentNode.style.display = 'none';\" onload=\"this.parentNode.style.backgroundImage='none'\" /></div><i style=\"display: none;\" class=\"uiIcon64x64FileDefault uiIcon64x64nt_file  "+
g+'"></i></div><div class="actionIconLabel" style="width: auto;"><a class="actionLabel" onclick="eXo.ecm.ECS.insertContent(this);" url="'+l+'" path="'+n+'" nodeType="'+p+'" rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(o)+'">'+decodeURIComponent(o)+"</a></div></div></div>")}if(e)f(e).html(i),e.style.display="";"list"==d?9<h?(eXo.ecm.Pager=new m("ListRecords",9),eXo.ecm.Pager.init(),eXo.ecm.Pager.showPageNav("pageNavPosition"),eXo.ecm.Pager.showPage(1)):f("#pageNavPosition").html(""):
8<h?(eXo.ecm.Pager=new m("ActionIconsContainer",8),eXo.ecm.Pager.init(),eXo.ecm.Pager.showPageNav("pageNavPosition"),eXo.ecm.Pager.showPage(1)):f("#pageNavPosition").html("")}};i.prototype.updateHTML=function(a){var b="",b="list"==a?'<div class="listView"><table class="uiGrid table table-hover table-striped" id="ListRecords"><thead><tr><th userLanguage="UserLanguage.FileName"> Name </th><th class="span2" userLanguage="UserLanguage.CreateDate"> Date </th><th class="span1" userLanguage="UserLanguage.FileSize"> Size </th></tr></thead><tbody></tbody></table></div>':
'<div class="uiThumbnailsView" style="overflow-y: auto; overflow-x: hidden;"><div class="actionIconsContainer" id="ActionIconsContainer"></div></div>';if(a=document.getElementById("RightWorkspace"))f(a).html(""),f(a).html(b+'<div class="PageIterator" id="pageNavPosition"></div><div style="clear: left;"><span></span></div>')};i.prototype.listFolders=function(a){var b=document.getElementById("RightWorkspace"),b=f(b).find("table")[0],d=f(b).find("tr");if(d&&0<d.length)for(var c=0;c<d.length;c++)0<c&&
b.deleteRow(d[c].rowIndex);if(!a||0>=a.length)a=b.tBodies[0].insertRow(0).insertCell(0),f(a).html("There is no content"),a.className="item noContent empty center",a.userLanguage="UserLanguage.NoContent",f("#pageNavPosition").html("");else{for(c=0;c<a.length;c++){eXo.ecm.ECS.getClazzIcon(a[c].getAttribute("nodeType"));var d=a[c].getAttribute("url"),g=a[c].getAttribute("path"),e=a[c].getAttribute("folderType"),h=a[c].getAttribute("title"),i=a[c].getAttribute("label");i||(i=h);h=b.tBodies[0].insertRow(c);
f(h.insertCell(0)).html('<a class="Item" url="'+d+'" path="'+g+'" nodeType="'+e+'" onclick="eXo.ecm.ECS.insertContent(this);">'+decodeURIComponent(i)+"</a>")}9<c?(eXo.ecm.Pager=new m("ListRecords",9),eXo.ecm.Pager.init(),eXo.ecm.Pager.showPageNav("pageNavPosition"),eXo.ecm.Pager.showPage(1)):f("#pageNavPosition").html("")}};i.prototype.listMutilFiles=function(a){var b=document.getElementById("RightWorkspace"),b=f(b).find("table")[0],d=f(b).find("tr");if(d&&0<d.length)for(var c=0;c<d.length;c++)0<
c&&b.deleteRow(d[c].rowIndex);if(!a||0>=a.length)a=b.tBodies[0].insertRow(0).insertCell(0),f(a).html("There is no content"),a.className="item noContent empty center",a.userLanguage="UserLanguage.NoContent",f("#pageNavPosition").html("");else{for(c=0;c<a.length;c++){eXo.ecm.ECS.getClazzIcon(a[c].getAttribute("nodeType"));var d=a[c].getAttribute("url"),g=eXo.ecm.ECS.repositoryName+":"+eXo.ecm.ECS.workspaceName+":"+a[c].getAttribute("path"),e=a[c].getAttribute("linkTarget"),h=a[c].getAttribute("nodeType"),
i=a[c].getAttribute("name"),s=b.tBodies[0].insertRow(c);f(s.insertCell(0)).html('<a class="Item" url="'+d+'" linkTarget ="'+e+'" path="'+g+'" nodeType="'+h+'" style = "overflow:hidden;" rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(i)+'" onclick="eXo.ecm.ECS.addFile2ListContent(this);">'+decodeURIComponent(i)+"</a>")}9<c?(eXo.ecm.Pager=new m("ListRecords",9),eXo.ecm.Pager.init(),eXo.ecm.Pager.showPageNav("pageNavPosition"),eXo.ecm.Pager.showPage(1)):f("#pageNavPosition").html("")}};
i.prototype.getClazzIcon=function(a){var b="";return!a?"DefaultPageIcon":b=a.replace("/","_").replace(":","_")+"16x16Icon"};m.prototype.setHeightRightWS=function(){var a=document.getElementById("LeftWorkspace"),b=document.getElementById("RightWorkspace");if(a)b.style.height=a.offsetHeight-30+"px"};m.prototype.init=function(){this.setHeightRightWS();var a=0;if("list"==eXo.ecm.ECS.viewType){var b=document.getElementById(eXo.ecm.Pager.tableName);0<=navigator.userAgent.indexOf("MSIE")?a=f(b).children("tbody")[0].childNodes.length:
(a=f(b).children("thead")[0],b=f(b).children("tbody")[0],a=(b?f(b).children("tr"):f(a).children("tr")).length)}else a=document.getElementById(eXo.ecm.Pager.tableName),icons=f(a).find("div.actionIconBox"),a=icons.length;this.pages=Math.ceil(a/eXo.ecm.Pager.itemsPerPage);if(0>this.pages)this.page=1;this.inited=!0};m.prototype.showRecords=function(a,b){if("list"==eXo.ecm.ECS.viewType)for(var d=null,c=document.getElementById(eXo.ecm.Pager.tableName),g=0,g=f(c).children("thead")[0],d=(c=f(c).children("tbody")[0])?
f(c).children("tr"):f(g).children("tr"),g=d.length-1,c=0;c<g+1;c++)c<a-1||c>b-1?d[c].style.display="none":f(d[c]).css("display","");else{d=null;g=document.getElementById(eXo.ecm.Pager.tableName);d=f(g).find("div.actionIconBox");g=d.length;for(c=0;c<g;c++)if(c<a-1||c>b-1)d[c].style.display="none";else{d[c].style.display="";var e=document.getElementById("thumbnail"+d[c].id);if(e.src||""==e.src)e.src=e.longDesc}}8>=g&&f("#pageNavPosition").html("")};m.prototype.showPage=function(a){if(this.inited){this.currentPage=
a;eXo.ecm.Pager.showPageNav("pageNavPosition");var b=f("#pageNavPosition"),d=f(b).find(".Previous:first")[0],b=f(b).find(".Next:first")[0];1==a?(d.parentNode.className="disabled",b.parentNode.className=""):a==this.pages?(b.parentNode.className="disabled",d.parentNode.className=""):(d.parentNode.className="",b.parentNode.className="");if(document.getElementById("pg"+eXo.ecm.Pager.currentPage)&&(d=document.getElementById("pg"+eXo.ecm.Pager.currentPage).parentNode))d.className="";if(document.getElementById("pg"+
eXo.ecm.Pager.currentPage)&&(d=document.getElementById("pg"+eXo.ecm.Pager.currentPage).parentNode))d.className="active";a=(a-1)*eXo.ecm.Pager.itemsPerPage+1;eXo.ecm.Pager.showRecords(a,a+eXo.ecm.Pager.itemsPerPage-1)}else alert("not inited")};m.prototype.previousPage=function(){1<this.currentPage&&eXo.ecm.Pager.showPage(this.currentPage-1)};m.prototype.nextPage=function(){this.currentPage<this.pages&&eXo.ecm.Pager.showPage(this.currentPage+1)};m.prototype.showPageNav=function(a){if(this.inited){var a=
document.getElementById(a),b,d=1,c=this.pages,g=dot2=-1;5<this.pages&&(4>this.currentPage?(c=3,g=4):this.currentPage>=this.pages-2?(d=this.pages-2,g=d-1):(d=this.currentPage-1,c=this.currentPage+1,g=2,dot2=this.pages-1));b='<div class="pagination uiPageIterator clearfix"><ul class="pull-right"><li><a onclick="eXo.ecm.Pager.previousPage();" class="Previous Page" rel="tooltip" data-placement="bottom" data-original-title="Previous Page"><i class="uiIconPrevArrow"></i></a></li>';for(var e=1;e<=this.pages;e++)if(1==
e&&1<d)b+='<li><a onclick="eXo.ecm.Pager.showPage('+e+');" id="pg'+e+'" >'+e+"</a></li>";else if(e==d)for(j=d;j<=c;j++)b+='<li><a onclick="eXo.ecm.Pager.showPage('+j+');" id="pg'+j+'" >'+j+"</a></li>";else e==g||e==dot2?b+='<li class="disabled"><a href="#">...</a></li>':e==this.pages&&c<this.pages&&(b+='<li><a onclick="eXo.ecm.Pager.showPage('+this.pages+');" id="pg'+this.pages+'">'+this.pages+"</a></li>");b=b+'<li><a onclick="eXo.ecm.Pager.nextPage();" class="Next Page" rel="tooltip" data-placement="bottom" data-original-title="Next Page"><i class="uiIconNextArrow"></i></a></li>'+
('</ul><p class="pull-right"><span>Total pages:</span> <span class="pagesTotalNumber">'+this.pages+"</span></p></div>");f(a).html(b)}else alert("not inited")};i.prototype.insertContent=function(a){if(a){var b=document.getElementById("RightWorkspace");if("folder"==eXo.ecm.ECS.typeObj||"one"==eXo.ecm.ECS.typeObj){for(var d=b.getAttribute("action"),d=d.substring(0,d.length-2),c=d+="&objectId="+encodeURIComponent(eXo.ecm.ECS.driverName)+":"+encodeURIComponent(eXo.ecm.ECS.repositoryName)+":"+encodeURIComponent(eXo.ecm.ECS.workspaceName)+
":"+encodeURIComponent(a.getAttribute("path"))+"')",g=c.indexOf("%27");-1!=g;)c=c.replace("%27","%2527"),g=c.indexOf("%27");eval(c)}else{for(var b=a.getAttribute("nodeType"),e=a.getAttribute("url"),c=e,g=c.indexOf("%27");-1!=g;)c=c.replace("%27","%2527"),g=c.indexOf("%27");e=encodeURIComponent(c);e=decodeURIComponent(e);c=encodeURIComponent(a.title);if(""==c)c=a.innerHTML;var c=decodeURIComponent(c),a="",h=eXo.ecm.ECS.currentEditor;if(""==eXo.ecm.ECS.components)window.opener.document.getElementById(eXp.getParameterValueByName("browserType"))?
window.opener.document.getElementById(eXp.getParameterValueByName("browserType")).value=a+e:(a=0<=b.indexOf("image")?a+('<img src="'+e+'" name="'+c+'" alt="'+c+'"/>'):a+('<a href="'+e+'">'+c+"</a>"),h.insertHtml(a),window.close(),h.OnAfterSetHTML=window.close());else var i=new Image,e=decodeURIComponent(e),d=function(){var a=i.height,c=i.width,b=window.opener.document,d=".cke_editor_"+eXo.ecm.ECS.currentEditor.name+"_dialog",g=null;f(b).find(d).each(function(){"block"==f(this).css("display")&&(g=
this)});f(g).find("div[name*='info']").find("input").each(function(b){if(0==b)this.value=this.src=e,this.style.display="block";else if(2==b)this.value=c;else if(3==b)this.value=a});b.getElementById(eXo.ecm.ECS.components).src=e;b.getElementById(eXo.ecm.ECS.components).style.display="block";window.close();h.OnAfterSetHTML=window.close()};i.onload=d;i.src=e;i.complete&&d()}}};i.prototype.insertMultiContent=function(a,b){var d=document.getElementById("RightWorkspace"),c=document.getElementById("ListFilesContent"),
g=f(c).find("tr");if(1>=g.length)d=eXo.ecm.WCMUtils.getBundle("ContentSelector.msg.no-file-selected",eXo.ecm.ECS.userLanguage),alert(d);else{for(var c="",e=0;e<g.length;e++){var h=f(g[e]).find("a.Item:first")[0];h&&(h=h.getAttribute("path"),c+=encodeURIComponent(h)+";")}g=d.getAttribute("action");if(a)if(d=d.getAttribute("actionSaveTemp"))c="&driverName="+this.driverName+"&currentPath="+encodeURIComponent(b)+"&itemPaths="+c,g=eXo.ecm.WCMUtils.addParamIntoAjaxEventRequest(d,c);else return;else if(g)g=
g.substring(0,g.length-2),g+="&objectId="+c+"')";else return;eval(g)}};i.prototype.addFile2ListContent=function(a){var b=document.getElementById("ListFilesContent");f(b).find("tr");var d=f(b).find("td.noContent:first")[0];d&&b.deleteRow(d.parentNode.rowIndex);var c=a.getAttribute("url"),g=a.getAttribute("nodeType"),d=a.getAttribute("path"),e=a.getAttribute("title");e||(e=a.getAttribute("data-original-title"));for(var a=a.getAttribute("linkTarget"),h=f(b).find("a.Item"),i=0;i<h.length;i++){var m=h[i].getAttribute("linkTarget");
if(a==m){alert("This content is already in the list content.");return}}b=b.tBodies[0].insertRow(b.children[0].children.length-1);b.className="Item";f(b.insertCell(0)).html('<a class="Item" url="'+c+'" linkTarget ="'+a+'" path="'+d+'" nodeType="'+g+' style = "overflow:hidden" rel="tooltip" data-placement="bottom" title="'+decodeURIComponent(e)+'">'+eXo.ecm.ECS.safe_tags_regex(e)+"</a>");b=b.insertCell(1);f(b).html('<a class="actionIcon" onclick="eXo.ecm.ECS.removeContent(this);"><i class="uiIconDelete uiIconLightGray""></i></a>');
b.className="center";this.insertMultiContent("SaveTemporary",d)};i.prototype.addFileSearchListSearch=function(){};i.prototype.loadListContent=function(a,b){if(a&&b){var d=document.getElementById("ListFilesContent"),c=a.split(";"),g=b.split(";");if(!(c.length>g.length)&&0<c.length){var e=f(d).find("td.noContent:first")[0];e&&d.deleteRow(e.parentNode.rowIndex);for(e=0;e<c.length-1;e++){var h=c[e],i=g[e],m=d.tBodies[0].insertRow(d.children[0].children.length-1),l=c[e].split("/"),l=l[l.length-1];f(m.insertCell(0)).html('<a class="Item" linkTarget ="'+
i+'" path="'+h+'">'+eXo.ecm.ECS.safe_tags_regex(decodeURIComponent(l))+"</a>");h=m.insertCell(1);f(h).html('<a class="actionIcon" onclick="eXo.ecm.ECS.removeContent(this);"><i class="uiIconDelete uiIconLightGray""></i></a>');h.className="center"}}}};i.prototype.removeContent=function(a){if(!0==confirm(this.deleteConfirmationMsg)){var b=document.getElementById("ListFilesContent"),a=f(a).parents("tr:first")[0];b.deleteRow(a.rowIndex);eXo.ecm.ECS.pathContent=!1;this.insertMultiContent("SaveTemporary",
this.initPathExpanded)}};i.prototype.changeFilter=function(){var a=document.getElementById("RightWorkspace");if("list"==eXo.ecm.ECS.viewType){var a=f(a).find("table")[0],b=f(a).find("tr");if(b&&0<b.length)for(var d=0;d<b.length;d++)0<d&&a.deleteRow(b[d].rowIndex)}else a=f(a).find("div.actionIconsContainer:first")[0],f(a).html("");eXo.ecm.ECS.currentNode&&eXo.ecm.ECS.getDir(eXo.ecm.ECS.currentNode,eXo.ecm.ECS.eventNode)};i.prototype.changeViewType=function(a){eXo.ecm.ECS.viewType=a;var b=document.getElementById("view");
f(b).html("");"list"==a?(f("#enableListViewBtn").attr("class","btn active"),f("#enableThumbnailViewBtn").attr("class","btn")):(f("#enableThumbnailViewBtn").attr("class","btn active"),f("#enableListViewBtn").attr("class","btn"));eXo.ecm.ECS.switchView=!0;if(eXo.ecm.ECS.currentNode)eXo.ecm.ECS.getDir(eXo.ecm.ECS.currentNode,eXo.ecm.ECS.eventNode);else if(b="",b="list"==a?'<div class="listView"><table class="uiGrid table table-hover table-striped" id="ListRecords"><thead><tr><th userLanguage="UserLanguage.FileName"> Name </th><th class="span2" userLanguage="UserLanguage.CreateDate"> Date </th><th class="span1" userLanguage="UserLanguage.FileSize"> Size </th></tr></thead><tr><td class="center empty" colspan="3" userLanguage="UserLanguage.NoContent">There is no content</td></tr></table></div>':
'<div class="uiThumbnailsView" style="overflow-y: auto; overflow-x: hidden;"><div class="actionIconsContainer" id="ActionIconsContainer"><div class="NoContent" userLanguage="UserLanguage.NoContent">There is no content</div></div></div>',a=document.getElementById("RightWorkspace"))f(a).html(""),f(a).html(b+'<div class="PageIterator" id="pageNavPosition"></div><div style="clear: left;"><span></span></div>');eXo.ecm.ECS.switchView=!1;a=document.getElementById("Filter");if(b=a.getAttribute("action"))b=
b.substring(0,b.length-2),b+="&objectId="+a.options[a.selectedIndex].value+"')",eval(b)};i.prototype.generateIdDriver=function(a){if(a){for(var b="";"Connector"!=a.tagName;)b=a.getAttribute("name").replace(" ","")+"_"+b,a=a.parentNode;return b}};i.prototype.generateIdNodes=function(a,b){if(a||b){for(var d="";"Folders"!=a.tagName;)d=a.getAttribute("name").replace(" ",""),d=b+"_"+d,a=a.parentNode;return d}};i.prototype.fixHeightTrees=function(){var a=document.getElementById("LeftWorkspace");if(a){var b=
document.getElementById("RightWorkspace"),d=f(window).height(),c=f(a).parents(".UIHomePageDT:first")[0],g=f(c).find("h6.TitleBar:first")[0],e=f(c).find("div.uiWorkingWorkspace:first")[0],h=f(e).find("div.actionBar:first")[0],c=0;if(h)c=h.offsetHeight;e=f(e).find("div.breadcumbsPortlet:first")[0];a.style.height=d-(g.offsetHeight+c+e.offsetHeight+55)+"px";if(b)b.style.height=d-(g.offsetHeight+c+e.offsetHeight+55)+"px"}};i.prototype.isShowFilter=function(){var a=document.getElementById("Filter"),a=f(a).parents(".actionBar:first")[0];
if("folder"==eXo.ecm.ECS.typeObj)a.style.display="none"};i.prototype.showUpload=function(){var a=document.getElementById("UploadItem");if(a)a.style.display="block"};i.prototype.hideUpload=function(){var a=document.getElementById("UploadItem");if(a)a.style.display="none"};i.prototype.languageInit=function(){if(eXp.userLanguage)for(var a=document.getElementsByTagName("*"),b=0;b<a.length;++b){if(a[b].getAttribute&&a[b].getAttribute("userLanguage")){var d=eval(a[b].getAttribute("userLanguage"));d&&(d=
document.createTextNode(d),f(a[b]).html(""),a[b].appendChild(d))}}else eXoPlugin.loadScript(window,"lang/en.js"),setTimeout(languageInit,1E3)};i.prototype.initPath=function(a,b,d){setTimeout('eXo.ecm.ECS.waitAndInitPath("'+a+'","'+b+'","'+d+'")',1E3)};i.prototype.waitAndInitPath=function(a,b,d){for(var a=a.replace(/ /g,""),b=b.replace(/ /g,""),d=document.getElementById(d),d=f(d).find("div.leftWorkspace")[0],d=f(d).find("a"),c=0;c<d.length;++c)if(d[c].getAttribute("id")){var g=d[c].getAttribute("id");
if(g&&0<=g.indexOf("_"+a+"_")){var e=f(d[c]).parents(".ChildrenContainer:first")[0],g=f(d[c]).parents(".node:first")[0];if(!e)break;e=e.previousSibling;if(!e)break;var h=e.firstChild.firstChild;eXo.ecm.ECS.renderBreadcrumbs(h);eXo.ecm.ECS.listRootFolder(h);eXo.ecm.ECS.actionColExp(e);b&&""!=b&&"/"!=b&&eXo.ecm.ECS.getDir(d[c],!1);eXo.ecm.ECS.expandTree("_"+a+"_",b,g);break}}};i.prototype.expandTree=function(a,b,d){var c=f(d).nextAll("div:first")[0];if(c&&!("ChildrenContainer"!=c.className||!b||""==
b)){var b=b.substring(1,b.length),g=b.indexOf("/"),a=a+"_"+b.substring(0,g),b=b.substring(g,b.length);if(0>b.indexOf("/")){a=0;for(b=d;"LeftWorkspace"!=b.getAttribute("id");){if(!b.previousSibling)b=b.parentNode;if("LeftWorkspace"!=b.getAttribute("id"))b=b.previousSibling;"node"==b.className&&(a+=27)}document.getElementById("LeftWorkspace").scrollTop=a}else{c=f(c).find("a");for(g=0;g<c.length;++g)if(c[g].getAttribute("id")&&(d=c[g].getAttribute("id"))&&0<=d.indexOf(a)){d=f(c[g]).parents(".node:first")[0];
eXo.ecm.ECS.getDir(c[g],!1);eXo.ecm.ECS.expandTree(a,b,d);break}}}};String.prototype.trunc=function(a,b){var d=this.length>a,c=d?this.substr(0,a-1):this,c=b&&d?c.substr(0,c.lastIndexOf(" ")):c;return d?c+"...":c};i.prototype.safe_tags_regex=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};eXo.ecm.ECS=new i;window.onresize=eXo.ecm.ECS.fixHeightTrees;return{ECS:eXo.ecm.ECS}}(r,t)});